#!/usr/bin/env ruby
#
# realtime
#
# Sends now_playing to pusher to update web clients

require 'app/boot'

sleep 2

last_song = nil

while true
  begin
    sleep 0.1
    if last_song != Play::Player.now_playing
      last_song = Play::Player.now_playing
      Play::Player.song_changed!
    end
  rescue Exception => e
    puts "An Exception: \n  #{e}"
  end
end